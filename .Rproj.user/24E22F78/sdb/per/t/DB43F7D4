{
    "contents" : "library(data.table)\nlibrary(xts)\noptions(datatable.print.topn=5)\noptions(datatable.print.nrows=5)\ntr <- fread(\"../MachineLearning/walmart/train.csv\",\n            sep = ',', header=T)\ntr[,date:=as.Date(date, \"%Y-%m-%d\")]\n\nte <- fread(\"../MachineLearning/walmart/test.csv\", sep = ',', header=T)\nte[,date:=as.Date(date, \"%Y-%m-%d\")]\n\n\nsetkey(tr, store_nbr, item_nbr)\nsetkey(te,  store_nbr, item_nbr)\n\nxreg <- data.table(xreg)\nsetkey(xreg, station_nbr)\n\nstore_nbr <- 2\nitem_nbr <- 5\nstation_nbr <- 14\n\ntrain <- xts(tr[.(2, 5), units], order.by = tr[.(2,5), date])\ntest  <- xts(order.by= te[.(2,5), date])\nds <- merge(train, test)\ndim(ds)\n\nxr <- xts(xreg[.(14), 3:27, with=F], order.by = xreg[.(14), date])\ndat <- merge(ds, xr, join = 'left')\ndim(dat)\n\n# modeling timeseries\ndat1 <- dat[\"2012::2013-03\"]\ndim(dat1)\nunits <- ts(dat1$train, frequency = 7)\nhead(dat1)\ncovariates <- as.matrix(dat1[,-1])\nhead(covariates)\ndim(covariates)\n\n# step1\nplot(units) # no trend, only seasonality\nacf(units)\n# step2\nplot(diff(units, lag=7))\nabline(h=0, col=2) # monthly seasonality ?\nacf(diff(units, lag=7))\npacf(diff(units, lag=7))\n\nlibrary(car)\nlibrary(forecast)\ncolnames(covariates)\nmod <- Arima(units, order=c(0,0,1), seasonal = list(order=c(0,0,1), period=7),\n             xreg=covariates[,c('rain', 'snow', 'bizday')])\nsummary(mod)\n\nacf(mod$resid)\nqqPlot(mod$resid)\nBox.test(mod$resid, lag=30, \"L\")\nplot(units, type='l')\nlines(fitted(mod), col=2)\nplot(mod$residuals)\n\n\ncolnames(covariates)\nmod2 <- auto.arima(units, xreg=covariates[,'bizday'])\nsummary(mod2)\nqqPlot(mod2$residuals)\nBox.test(mod2$resid, lag=30, \"L\")\n\n\ndf <- data.frame(uni = ts(dat1$train, frequency=7), dat1[,-1])\nclass(df$uni)\nmod3 <- tslm(uni ~., data=df)\nsummary(mod3)\n\n\n",
    "created" : 1433316822088.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1108217098",
    "id" : "DB43F7D4",
    "lastKnownWriteTime" : 1432040825,
    "path" : "/home/sergey/R_WalMart/forecast_wallmart.R",
    "project_path" : "forecast_wallmart.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "type" : "r_source"
}